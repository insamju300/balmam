<!DOCTYPE html>
<html>
<head>
    <title>Location Details with Google Maps</title>
    <script src="/js_keys.js"></script>
    <script id="script" type="text/javascript" charset="utf-8"></script>
    <script>
      document.getElementById("script").src = 'https://maps.googleapis.com/maps/api/js?key=' + GOOGLE_MAP_KEY + '&libraries=places';
    
    
    </script>
</head>
<body>
    <button id="getDetails">위치 정보 얻기</button>
    <script>
        let map;
        let service;
        let infowindow;

        function initService() {
            // 지도 객체를 생성하지만, 실제로는 화면에 표시하지 않습니다.
            map = new google.maps.Map(document.createElement('div'));
            service = new google.maps.places.PlacesService(map);
            infowindow = new google.maps.InfoWindow();
        }

        function getLocationDetails(latlng) {
            // 현재 위치에 대한 상세 정보 조회
            service.getDetails({
                placeId: latlng.placeId
            }, function(place, status) {
                if (status === google.maps.places.PlacesServiceStatus.OK) {
                    
                    console.log(`장소 명: ${place.name}`);
                    console.log(`별점: ${place.rating}`);
                    console.log(`사진 링크: ${place.photos ? place.photos[0].getUrl() : '사진 없음'}`);
                    console.log(`리뷰 수: ${place.user_ratings_total}`);
                    console.log(`카테고리: ${place.types.join(', ')}`);
                    //추가적으로 필요한 정보가 있다면 여기에 코드 추가
                }
            });
        }

        document.getElementById('getDetails').addEventListener('click', function() {
            initService();

            navigator.geolocation.getCurrentPosition(function(position) {
                const userLocation = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

                // 현재 위치에서 가장 가까운 장소의 Place ID를 찾습니다.
                service.nearbySearch({
                    location: userLocation,
                    radius: '10' // 매우 작은 반경을 지정하여 현재 위치와 가장 가까운 장소를 찾습니다.
                }, function(results, status) {
                    if (status === google.maps.places.PlacesServiceStatus.OK && results[0]) {
                        // 가장 가까운 장소의 상세 정보를 조회합니다.
                        getLocationDetails({placeId: results[0].place_id});
                    }
                });
            });
        });

        //https://developers.google.com/maps/documentation/javascript/reference/places-service?hl=ko#PlaceDetailsRequest.placeId
        //도시도 받아올 수 있는듯
        //관광지 기준 뭘로잡을지가 중요. 머무른시간만 잘 체크하면 될듯.
        //장소의 유형 https://developers.google.com/maps/documentation/places/web-service/supported_types?hl=ko&_gl=1*1i1xqni*_up*MQ..*_ga*MTM4NTAzOTkzNC4xNzA5MTg3NDM5*_ga_NRWSTWS78N*MTcwOTE4NzQzOC4xLjAuMTcwOTE4NzQzOC4wLjAuMA..


        //지원되는 위치 목록
        // accounting
        // airport
        // amusement_park
        // aquarium
        // art_gallery
        // atm
        // bakery
        // bank
        // bar
        // beauty_salon
        // bicycle_store
        // book_store
        // bowling_alley
        // bus_station
        // cafe
        // campground
        // car_dealer
        // car_rental
        // car_repair
        // car_wash
        // casino
        // cemetery
        // church
        // city_hall
        // clothing_store
        // convenience_store
        // courthouse
        // dentist
        // department_store
        // doctor
        // drugstore
        // electrician
        // electronics_store
        // embassy
        // fire_station
        // florist
        // funeral_home
        // furniture_store
        // gas_station
        // gym
        // hair_care
        // hardware_store
        // hindu_temple
        // home_goods_store
        // hospital
        // insurance_agency
        // jewelry_store
        // laundry
        // lawyer
        // library
        // light_rail_station
        // liquor_store
        // local_government_office
        // locksmith
        // lodging
        // meal_delivery
        // meal_takeaway
        // mosque
        // movie_rental
        // movie_theater
        // moving_company
        // museum
        // night_club
        // painter
        // park
        // parking
        // pet_store
        // pharmacy
        // physiotherapist
        // plumber
        // police
        // post_office
        // primary_school
        // real_estate_agency
        // restaurant
        // roofing_contractor
        // rv_park
        // school
        // secondary_school
        // shoe_store
        // shopping_mall
        // spa
        // stadium
        // storage
        // store
        // subway_station
        // supermarket
        // synagogue
        // taxi_stand
        // tourist_attraction
        // train_station
        // transit_station
        // travel_agency
        // university
        // veterinary_care
        // zoo
    </script>


</body>
</html>